FROM node:20-alpine

WORKDIR /app

COPY package*.json package-lock.json ./

RUN npm i

COPY ./prisma prisma

COPY . .

EXPOSE 3000
# Se o banco estiver rodando e acessivel ele roda um migrate dev e dps um run dev
CMD sh -c 'until nc -z db-dev 6520; do sleep 1; done; npx prisma migrate dev; npm run dev'
